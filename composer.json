{
    "name": "daniel-km/omeka-s-module-adminer",
    "description": "Access to Omeka database through Adminer, a one-file full-featured database management tool.",
    "type": "library",
    "require": {
        "vrana/adminer": "^4.7"
    },
    "license": "CECILL-2.1",
    "authors": [
        {
            "name": "Daniel Berthereau",
            "email": "Daniel.git@Berthereau.net"
        }
    ],
   "scripts": {
        "post-install-cmd": "@build",
        "post-update-cmd": "@build",
        "build": [
            "@composer install --working-dir=vendor/vrana/adminer",

            "# Hack to use the css with Adminer via the Omeka route.",
            "sed --in-place 's~$filename = \"adminer.css\";~$filename = \"modules/Adminer/asset/vendor/adminer/adminer.css\";~' vendor/vrana/adminer/adminer/include/adminer.inc.php",
            "sed --in-place 's~$return\\[\\] = \"$filename?v=\" . crc32(file_get_contents($filename));~$return\\[\\] = \"../$filename?v=\" . crc32(file_get_contents(\"../$filename\"));~' vendor/vrana/adminer/adminer/include/adminer.inc.php",
            "@php -f 'vendor/vrana/adminer/compile.php' -- mysql",
            "mv $(ls adminer-*-mysql.php) view/adminer/admin/index/adminer-mysql.phtml",

            "# Hack to use the css with Adminer editor via the Omeka route.",
            "sed --in-place 's~$filename = \"adminer.css\";~$filename = \"modules/Adminer/asset/vendor/adminer/adminer.css\";~' vendor/vrana/adminer/editor/include/adminer.inc.php",
            "sed --in-place 's~$return\\[\\] = $filename;~$return\\[\\] = \"../$filename?v=\" . crc32(file_get_contents(\"../$filename\"));~' vendor/vrana/adminer/editor/include/adminer.inc.php",
            "@php -f 'vendor/vrana/adminer/compile.php' -- editor mysql",
            "mv $(ls editor-*-mysql.php) view/adminer/admin/index/adminer-editor-mysql.phtml",

            "cp vendor/vrana/adminer/designs/lucas-sandery/adminer.css asset/vendor/adminer/adminer.css"
        ]
    }
}
